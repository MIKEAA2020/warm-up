function [ Error ] = ObjFun( w )
%Finds the sum of squared residuals
Ydata = [2.53643100000000;2.58403400000000;2.63086200000000;2.67760900000000;2.72484700000000;2.77302000000000;2.82244300000000;2.87330600000000;2.92568700000000;2.97957600000000;3.03495000000000;3.09184400000000;3.15042100000000;3.21100100000000;3.27397800000000;3.33958400000000;3.40792300000000;3.47877000000000;3.55159900000000;3.62568100000000;3.70043700000000;3.77576000000000;3.85165100000000;3.92778100000000;4.00379400000000;4.07948000000000;4.15466700000000;4.22950600000000;4.30453400000000;4.38050600000000;4.45800300000000;4.53699700000000;4.61738700000000;4.69956900000000;4.78401200000000;4.87092200000000;4.96056800000000;5.05252200000000;5.14542600000000;5.23744100000000;5.32723100000000;5.41428900000000;5.49892000000000;5.58159800000000;5.66315000000000;5.74421300000000;5.82489200000000;5.90504600000000;5.98479400000000;6.06423900000000;6.14349400000000;6.22262700000000;6.30177300000000;6.38118500000000;6.46115900000000;6.54190700000000;6.62351800000000;6.70594700000000;6.78908900000000;6.87276700000000;6.95682400000000;7.04119400000000;7.12582800000000;7.21058200000000;7.29529100000000;7.37979700000000;7.46402200000000;7.54785900000000;7.63109100000000;7.71346800000000;7.79479900000000]';
t = 1500:2500;
lags=w(1);
r = w(2); 
rm = w(3) ;
Kb = w(4) ;
K0 = w(5) ;
N0 = w(6) ;
% lags = 100;
% %  hist = @(t) 0.5*t;
% r = 0.02093;
% rm = 0.193;
Ka = 0; %% changed from zero
% Kb = 3;%from one to 500
% K0 = 0.0002500;
% N0 = 0.0002500;
 sol = dde23(@(t,N,Nlag)Bilogistic(t,N,Nlag,Ka,Kb,r,rm,K0),lags,@(t)Nhist(t,N0,Ka,r ),[1500,2500]);
Xdata = 1950:2020;
 Model_Predictions = deval(sol,Xdata);
Error = sum((Ydata-Model_Predictions).^2);

end

